\section{Аппроксимация функций}

Для наших целей понадобится приближать наши функции другими, более понятными.

\begin{definition}
    Функция $f : \R^{n} \rightarrow \R$ называется ступенчатой, если она является линейной комбинацией индикаторов ячеек.
\end{definition}

Теперь докажем, что такое функции приближают по норме $L_p.$

\begin{theorem}
    Пусть множество $E \subseteq \R^n$ измеримо, $f \in L_p(E), $ где $p \in [1, +\infty).$ Тогда верно следующее:
    $$\forall \varepsilon > 0 \ \exists \ \text{ступенчатая функция } h_{\varepsilon} : ||f - h_{\varepsilon}||_{L_p(E)} < \varepsilon.$$
\end{theorem}

\underline{Идея доказательства:} как обычно мы доказываем это сначала для простых функций, а позже для всех, сводя к уже доказанному с помощью приближений.

\begin{proof} Разобьем доказательство на шаги

\begin{enumerate}
    \item Пусть $f = I_{G},$ где множество $G$ имеет конечную меру. Тогда из определения верхней меры следует:
    $$\forall \varepsilon > 0 \ \exists \{P_{k}\}_{k = 1}^{\infty} : \ \lambda^n(G) + \varepsilon \geq \sum_{k  =1}^{\infty}\lambda(P_k).$$
    Теперь из сходимости ряда мер ячеек следует, что можно взять такой большой номер $N:$
    $$\sum_{k = N + 1}^{\infty} \lambda^n(P_k) < \varepsilon.$$
    По теореме о дизъюнктном представлении в полукольце существует набор непересекающихся $\{Q_l\}_{l = 1}^{m}: \ P_1 \cup \ldots \cup P_N = \bigsqcup_{l = 1}^mQ_l.$ Обозначим за $A = \bigcup_{i = 1}^{\infty} P_k,  B = P_1 \cup \ldots \cup P_N.$ Тогда  
    $$I_{B} = \sum_{l = 1}^{m}I_{Q_l}.$$
    Возьмем в качестве приближающей ступенчатой функции $I_{B}.$ Осталось доказать, что она приближает с точностью до $\varepsilon$ по норме.
    $$||f - h||_{L_p} = \left( \int_{\R^n} |I_G(x) - I_B(x)|^p dx\right)^{\frac{1}{p}} \leq$$
    $$\leq \left( \int_{\R^n} |I_G(x) - I_A(x)|^p dx\right)^{\frac{1}{p}} + \left( \int_{\R^n} |I_A(x) - I_B(x)|^p dx\right)^{\frac{1}{p}} = $$
    $$= \left( \lambda^n(A \setminus G)\right)^{\frac{1}{p}} + \left( \lambda^n(A \setminus B) \right)^{\frac{1}{p}} \leq 2\varepsilon^{\frac{1}{p}}$$
    \item Если $f$ -- простая, то есть линейная комбинация индикаторов множеств конечной меры, явно сводится к пункту $1$ с помощью неравенства треугольника.
    \item $f \in L_p(E)$ произвольная, тогда из определения интеграла Лебега можно ее приблизить простой с точностью до $\varepsilon / 2, $а простые мы уже умеем приближать ступенчатыми с точностью до $\varepsilon / 2.$ Осталось применить неравенство треугольника и требуемое будет доказано 
\end{enumerate}
\end{proof}

Теперь, благодаря доказанной технике можем доказать следующую теорему:
\begin{theorem}
    Пусть $f \in L_p(\R^n), $ где $p \in [1, +\infty).$ Тогда верно следующее:
    $$||f(x) - f(x - h)||_{L_p} \rightarrow 0, h \rightarrow 0$$
\end{theorem}

\underline{Идея доказательства:} Обозначим за $f_h(x) = (x - h),$ заметим, что в силу неравенства треугольника:
$$||f - f_h|| \leq ||f - g|| + ||g - g_h|| + ||f_h - g_h|| \ \forall g \in L_p(\R^n)$$
Ясно, что можно $g$ можно подобрать, чтобы 1 и 3 слагаемые были маленькими, проблема лишь в том, чтобы уменьшить второе слагаемое.  

\begin{proof}
    Заметим, что для любой функции $g \in L_p(\R^n):$
    $$||f_h - g_h|| = \int_{\R^n}|f(x - h) - g(x - h)| dx = \{\text{выполним замену переменной } t = x - h\}=$$
    $$= \int_{\R^n} |f(t) - g(t)| dt = ||f - g||$$
    Тогда в качестве $g$ возьмем ступенчатую функцию, которая приближает $f.$ Осталось теперь доказать, что $g$ можно приблизить $g_h.$ Из теоремы о дизъюнктном представлении следует, что $g$ можно представить в виде:
    $$g(x) = \sum_{k = 1}^{n}a_k I_{Q_k}(x), \ Q_k -\text{ячейка}$$
    $$||g - g_h||_p \leq \sum_{k = 1}^{n} |a_k| \cdot ||I_{Q_k} - I_{Q_k + h}||$$
    Что стремится к нулю при $h \longrightarrow 0.$
\end{proof}

\begin{lemma}
    Пусть $f: \R^n \rightarrow \R$ измеримая функция, тогда отображения
    $$(x, y) \rightarrow f(x - y)$$
    $$(x, y) \rightarrow f(x + y)$$
    измеримы.
\end{lemma}

\begin{proof}
    Докажем первое утверждение, второе доказывается аналогично. Обозначим за $E_c = \{x | \ f(x) > c\},$ оно является измеримым из условия леммы. Теперь рассмотрим следующее линейное отображение:
    $$T: (x, y) \longrightarrow (x - y, y).$$
    Оно обратимо, так как определено обратное отображение $T^{-1}((x, y)) = (x + y, y).$ Осталось лишь заметить, что верно:
    $$\{(x, y) | x - y \in E_c\} = T^{-1}(E_C \times \R^n) = \{(x, y) | \ f(x - y) > c\} .$$
    Отсюда следует требуемое.
\end{proof}

Теперь мы готовы к определению свертки функций и к доказательству корректности этого определения.

\begin{theorem}
    Пусть $f, g \in L_1(\R^n).$ Тогда
    \begin{enumerate}
        \item Для $\lambda-$почти всех $x \in \R^n$ корректно определена функция (будет называть ее сверткой) $f*g(x) := \int_{\R^n}f(x - y)g(y) dy.$
        \item $f* g$ измерима в широком смысле.
        \item $f * g \in L_1(\R^n)$
        \item $||f * g||_{L_1} \leq ||f||_{L_1} \cdot ||g||_{L_1}$
    \end{enumerate}
\end{theorem}

\begin{proof}
    Рассмотрим следующую функцию:
    $$H(x, y) = |f(x - y)| \cdot |g(y)|.$$
    Ясно, что это неотрицательная, измеримая функция, тогда по теореме Тонелли:
    $$\iint_{\R^{2n}}H(x, y) dx dy = \int_{\R^n}\left( \int_{\R^n} H(x, y) dy\right) dx = \int_{\R^n}\left( \int_{\R^n} H(x, y) dx\right) dy.$$
    Подробнее остановимся на втором интеграле, внутренний интеграл преобразуется так:
    $$\int_{\R^n} H(x, y) dx = \int_{\R^n} |f(x - y)| \cdot |g(y)| dx = |g(y)| \int_{\R^n}|f(x - y)|dx = |g(y)| \cdot ||f||_{L_1}$$
    Тогда весь интеграл:
    $$ \int_{\R^n}\left( \int_{\R^n} H(x, y) dx\right) dy = ||f||_{L_1} \cdot  \int_{\R^n} |g(y) dy = ||f||_{L_1} \cdot ||g||_{L_1} < + \infty$$
    Теперь применим теорему Фубини для $F(x, y) = f(x - y) g(y),$ так как выше мы показали, что $F(x, y) \in L_1(\R^{2n}).$ Тогда пункты $1, 2$ из нее сразу следуют. Покажем оставшиеся:
    $$\int_{\R^n}|f*g|(x) dx \leq \int_{\R^n}\left( \int_{\R^n} |f(x - y)| \cdot |g(y)| dy \right) dx = ||f||_{L_1} \cdot ||g||_{L_1}$$
\end{proof}

Сформулируем еще одну теорему

\begin{theorem}
    Пусть $p \in [1, +\infty), \ f \in L_p(\R^n), \ g \in L_{p'}(\R^n), $ где $\frac{1}{p} + \frac{1}{p'} = 1.$ Тогда:
    \begin{enumerate}
        \item $f * g(x)$ корректно определена для всех $x \in \R^n.$
        \item $f * g(x)$ равномерно непрерывна на $R^n.$
    \end{enumerate}
\end{theorem}

\begin{proof}
Докажем последовательно
    \begin{enumerate}
        \item По неравенству Гельдера получаем:
        $$|f * g(x)| \leq \int_{R^n}|f(x - y)| \cdot |g(y)| dy \leq ||f||_{L_p} \cdot ||g||_{L_{p
        '}} < + \infty$$
        \item Обозначим за $(f * g)_h(x) = f * g(x - h), f_h(x) = f(x -h).$ Верно равенство:
        $$(f * g)_h(x) - f * g(x) = \int_{R^n} f(x - y -h) g(y)dy - f*g(x) = f_h * g(x) - f*g(x)$$
        Теперь оценим отклонение свертки при сдвиге:
        $$|(f * g)_h(x) - f * g(x)| = |f_h * g(x) - f*g(x)| \leq ||f_h - f| * g(x)| \leq ||f-f_h||_{L_p} \cdot ||g ||_{L_p'}$$
        Теперь по уже доказанному утверждению,  получаем, что правая часть стремится к $0$ и при этом оценка не зависит от $x.$ Таким образом, требуемое доказано.
        \item Осталось рассмотреть случаи, когда одно из $p, p'$ равно $+\infty.$ А именно рассмотрим случай, когда $p = \infty, p' = 1.$ Для этого случая достаточно лишь заметить, что совершенно аналогично доказывается неравенство:
        $$|f * g(x)| \leq ||f||_{L_1} \cdot ||g||_{L_{\infty}}$$
    \end{enumerate}
\end{proof}

\subsection{Аппроксимативная едининца}

\begin{definition}
    Назовем семейство функций $\{w_t(x)\}_{t\in(0, +\infty)}$ аппроксимативной единицей, если $\forall t > 0:$
    \begin{enumerate}
        \item $$w_t(x) \geq 0, \forall x \in \R^n$$
        \item $$\int_{\R^n}w_t(x) dx = 1$$
        \item $$\forall \delta > 0 \lim_{t \rightarrow +0} \int_{\R^n \setminus B_{\delta}(0)} w_t(x) dx = 0$$
    \end{enumerate}
\end{definition}

\begin{example}
    Соболевской шапкой назовем следующую функцию:
    $$\psi(x) = \begin{cases}
        e^{-\frac{1}{1-||x||^2}}, \  x \in(-1, 1) \\
        0, \ x \notin (-1, 1)
    \end{cases}$$
\end{example}